{"ast":null,"code":"import React, { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport { Group } from '@vx/group';\nimport { Circle } from '@vx/shape';\nimport { LinearGradient } from '@vx/gradient';\nimport { scaleLinear } from '@vx/scale';\nimport { useTooltip, Tooltip } from '@vx/tooltip';\n\nfunction Compd() {\n  const [data, setData] = useState([]);\n  const {\n    tooltipData,\n    tooltipLeft,\n    tooltipTop,\n    tooltipOpen,\n    showTooltip,\n    hideTooltip\n  } = useTooltip();\n  useEffect(() => {\n    (async () => {\n      let a = await axios.get('https://raw.githubusercontent.com/nychealth/coronavirus-data/master/tests-by-zcta.csv');\n      let res = await a.data;\n      let dump = [],\n          lines = res.split('\\r'),\n          headers = lines[0].split(',');\n\n      for (let i = 1; i < lines.length; i++) {\n        let obj = {},\n            line = lines[i].replace('\\n', ''),\n            curLine = line.split(',');\n\n        if (parseInt(curLine[0]) == 99999 || !parseInt(curLine[0])) {\n          continue;\n        }\n\n        for (let j = 0; j < headers.length; j++) {\n          obj[headers[j].toLowerCase().replace('.', '_')] = curLine[j] || 0;\n        }\n\n        dump.push(obj);\n      }\n\n      setData(dump);\n    })();\n  }, []);\n  let tooltipTimeout;\n\n  const positive = d => d.positive,\n        total = d => d.total,\n        zip = d => d.modzcta,\n        x = d => d[0],\n        y = d => d[1],\n        z = d => d[2];\n\n  const width = 400,\n        height = 600,\n        xMax = width,\n        yMax = height - 80;\n  const xScale = scaleLinear({\n    domain: [Math.min(...data.map(modzcta)), Math.max(...data.map(dmodzcta))],\n    range: [0, xMax],\n    clamp: true\n  });\n  const yScale = scaleLinear({\n    domain: [Math.min(...data.map(total)), 1.6],\n    range: [yMax, 0],\n    clamp: true\n  });\n  return /*#__PURE__*/React.createElement(React.Fragment, null);\n}\n\nexport default Compd;","map":{"version":3,"sources":["/Users/qorka/Projects/covid/ui/src/components/compd.js"],"names":["React","useState","useEffect","axios","Group","Circle","LinearGradient","scaleLinear","useTooltip","Tooltip","Compd","data","setData","tooltipData","tooltipLeft","tooltipTop","tooltipOpen","showTooltip","hideTooltip","a","get","res","dump","lines","split","headers","i","length","obj","line","replace","curLine","parseInt","j","toLowerCase","push","tooltipTimeout","positive","d","total","zip","modzcta","x","y","z","width","height","xMax","yMax","xScale","domain","Math","min","map","max","dmodzcta","range","clamp","yScale"],"mappings":"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","sourcesContent":["  import React, { useState, useEffect } from 'react'\n  import axios from 'axios'\n  import { Group } from '@vx/group'\n  import { Circle } from '@vx/shape'\n  import { LinearGradient } from '@vx/gradient'\n  import { scaleLinear } from '@vx/scale'\n  import { useTooltip, Tooltip } from '@vx/tooltip'\n\nfunction Compd() {\n  const [data, setData] = useState([])\n  const {\n    tooltipData,\n    tooltipLeft,\n    tooltipTop,\n    tooltipOpen,\n    showTooltip,\n    hideTooltip,\n  } = useTooltip()\n\n  useEffect(() => {\n    (async() => {\n      let a = await axios.get('https://raw.githubusercontent.com/nychealth/coronavirus-data/master/tests-by-zcta.csv')\n      let res = await a.data\n  \n      let \n        dump = [],\n        lines = res.split('\\r'),\n        headers = lines[0].split(',')\n\n      for (let i = 1; i < lines.length; i++) {\n        let\n          obj = {},\n          line = lines[i].replace('\\n', ''),\n          curLine = line.split(',')\n          \n        if (parseInt(curLine[0]) == 99999 || !parseInt(curLine[0])) { continue }\n    \n        for (let j = 0; j < headers.length; j++) {\n          obj[headers[j].toLowerCase().replace('.', '_')] = curLine[j] || 0\n        }\n\n        dump.push(obj)\n      }\n\n      setData(dump)\n    })()\n  }, [])\n\n  let tooltipTimeout\n\n  const \n    positive = d => d.positive,\n    total = d => d.total,\n    zip = d => d.modzcta,\n    x = d => d[0],\n    y = d => d[1],\n    z = d => d[2]\n\n  const\n    width = 400,\n    height = 600,\n    xMax = width,\n    yMax = height - 80\n\n  const xScale = scaleLinear({\n    domain: [Math.min(...data.map(modzcta)), Math.max(...data.map(dmodzcta))],\n    range: [0, xMax],\n    clamp: true\n  })\n\n  const yScale = scaleLinear({\n    domain: [Math.min(...data.map(total)), 1.6],\n    range: [yMax, 0],\n    clamp: true\n  })\n\n  return (\n    <>\n      {/* <svg width={width} height={height}>\n        <LinearGradient \n            from=\"#b39cea\" \n            to=\"#e99cea\" \n            id=\"gradient\"/>\n        <rect width={width} height={height} fill=\"#fbc2eb\" rx={14} />\n        <Group\n          onTouchStart={event => {\n            if (tooltipTimeout) clearTimeout(tooltipTimeout)\n            props.hideTooltip()\n          }}\n        >\n          {points.map((point, i) => {\n            const cx = xScale(x(point))\n            const cy = yScale(y(point))\n            const r = i % 3 === 0 ? 2 : 2.765\n            return (\n              <Circle\n                key={`point-${point.x}-${i}`}\n                className=\"dot\"\n                cx={cx}\n                cy={cy}\n                r={r}\n                fill=\"#f6c431\"\n                onMouseEnter={event => {\n                  if (tooltipTimeout) clearTimeout(tooltipTimeout)\n                  props.showTooltip({\n                    tooltipLeft: cx,\n                    tooltipTop: cy + 20,\n                    tooltipData: point\n                  })\n                }}\n                onMouseLeave={event => {\n                  tooltipTimeout = setTimeout(() => {\n                    props.hideTooltip()\n                  }, 300)\n                }}\n                onTouchStart={event => {\n                  if (tooltipTimeout) clearTimeout(tooltipTimeout)\n                  props.showTooltip({\n                    tooltipLeft: cx,\n                    tooltipTop: cy - 30,\n                    tooltipData: point\n                  })\n                }}\n              />\n            )\n          })}\n        </Group>\n      </svg>\n      {props.tooltipOpen && (\n        <Tooltip left={props.tooltipLeft} top={props.tooltipTop}>\n          <div>\n            <strong>x:</strong> {x(props.tooltipData)}\n          </div>\n          <div>\n            <strong>y:</strong> {y(props.tooltipData)}\n          </div>\n        </Tooltip>\n      )} */}\n    </>\n  )\n}\n\nexport default Compd\n"]},"metadata":{},"sourceType":"module"}