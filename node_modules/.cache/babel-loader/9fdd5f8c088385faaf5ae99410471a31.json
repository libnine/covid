{"ast":null,"code":"import _regeneratorRuntime from\"/Users/qorka/Projects/covid/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/qorka/Projects/covid/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/qorka/Projects/covid/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from'react';import axios from'axios';import{localPoint}from'@vx/event';import{LinearGradient}from'@vx/gradient';import{Group}from'@vx/group';import{Pie}from'@vx/shape';import{useTooltip,Tooltip}from'@vx/tooltip';var Compc=function Compc(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),data=_useState2[0],setData=_useState2[1];var _useTooltip=useTooltip(),tooltipData=_useTooltip.tooltipData,tooltipLeft=_useTooltip.tooltipLeft,tooltipTop=_useTooltip.tooltipTop,tooltipOpen=_useTooltip.tooltipOpen,showTooltip=_useTooltip.showTooltip,hideTooltip=_useTooltip.hideTooltip;useEffect(function(){_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var a,res,dump,lines,headers,i,obj,line,curLine,j;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return axios.get('https://raw.githubusercontent.com/nychealth/coronavirus-data/master/by-age.csv');case 2:a=_context.sent;_context.next=5;return a.data;case 5:res=_context.sent;dump=[],lines=res.split('\\r'),headers=lines[0].split(',');i=1;case 8:if(!(i<lines.length)){_context.next=17;break;}obj={},line=lines[i].replace('\\n',''),curLine=line.split(',');if(!curLine[0].match(/Citywide\\s\\S+/gi)){_context.next=12;break;}return _context.abrupt(\"continue\",14);case 12:for(j=0;j<headers.length;j++){obj[headers[j].toLowerCase()]=curLine[j].replace(/[\\sA-Za-z]/gi,'');}dump.push(obj);case 14:i++;_context.next=8;break;case 17:setData(dump);case 18:case\"end\":return _context.stop();}}},_callee);}))();},[]);var width=650,height=400,radius=Math.min(width,height)-100;var Label=function Label(_ref2){var x=_ref2.x,y=_ref2.y,children=_ref2.children;if(children===\"75\"){children=\"75+\";}return/*#__PURE__*/React.createElement(\"text\",{fontFamily:\"Snoopy\",fill:\"white\",textAnchor:\"middle\",x:x*1.25,y:y*1.25,dy:\"-.25em\",fontSize:16},Math.abs(x)<10?null:children);};return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"div\",{className:\"svgWrapper\"},/*#__PURE__*/React.createElement(\"svg\",{width:width,height:height},/*#__PURE__*/React.createElement(LinearGradient,{from:\"#fbc2eb\",to:\"#ede1ed\",id:\"gradient\"}),/*#__PURE__*/React.createElement(LinearGradient,{from:\"#736ca3\",to:\"#b8c1e3\",id:\"gradient-2\"}),/*#__PURE__*/React.createElement(\"rect\",{width:width,height:height,fill:\"url('#gradient')\",rx:14}),/*#__PURE__*/React.createElement(Group,{top:height/2,left:width/2},/*#__PURE__*/React.createElement(Pie,{data:data,outerRadius:radius-115,pieValue:function pieValue(d){return d.death_rate;}},function(_ref3){var arcs=_ref3.arcs,path=_ref3.path;return arcs.map(function(arc,i){var _path$centroid=path.centroid(arc),_path$centroid2=_slicedToArray(_path$centroid,2),x=_path$centroid2[0],y=_path$centroid2[1];return/*#__PURE__*/React.createElement(\"g\",{key:\"pie-arc-\".concat(i)},/*#__PURE__*/React.createElement(\"path\",{d:path(arc),fill:\"url('#gradient-2')\",stroke:\"white\",onMouseEnter:function onMouseEnter(){return showTooltip({tooltipData:arc.data,tooltipLeft:x,tooltipTop:y});},onMouseLeave:hideTooltip}),/*#__PURE__*/React.createElement(Label,{x:x,y:y},arc.data.age_group));});}))),tooltipOpen&&/*#__PURE__*/React.createElement(Tooltip,{left:tooltipLeft*.75+width,top:tooltipTop*1.25+height},/*#__PURE__*/React.createElement(\"section\",{className:\"ttStyle\"},/*#__PURE__*/React.createElement(\"strong\",null,\"Age Group\"),\" \",tooltipData.age_group,/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(\"strong\",null,\"Case Rate\"),\" \",(tooltipData.covid_case_rate/1000).toPrecision(3).toLocaleString(),\"%\",/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(\"strong\",null,\"Hospitalization Rate\"),\" \",(tooltipData.hospitalized_case_rate/1000).toPrecision(3).toLocaleString(),\"%\",/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(\"strong\",null,\"Death Rate\"),\" \",(tooltipData.death_rate/1000).toPrecision(3).toLocaleString(),\"%\",/*#__PURE__*/React.createElement(\"br\",null)))),/*#__PURE__*/React.createElement(\"div\",{className:\"descDiv\"},/*#__PURE__*/React.createElement(\"div\",{className:\"headerWrap\"},/*#__PURE__*/React.createElement(\"span\",{className:\"descriptionHeader\"},\"Age Groups\")),/*#__PURE__*/React.createElement(\"div\",{className:\"descWrap\"},/*#__PURE__*/React.createElement(\"span\",{className:\"description\"},\"This contains age-specific rates of confirmed cases, hospitalizations, and deaths.\"))));};export default Compc;","map":{"version":3,"sources":["/Users/qorka/Projects/covid/ui/src/components/compc.js"],"names":["React","useEffect","useState","axios","localPoint","LinearGradient","Group","Pie","useTooltip","Tooltip","Compc","data","setData","tooltipData","tooltipLeft","tooltipTop","tooltipOpen","showTooltip","hideTooltip","get","a","res","dump","lines","split","headers","i","length","obj","line","replace","curLine","match","j","toLowerCase","push","width","height","radius","Math","min","Label","x","y","children","abs","d","death_rate","arcs","path","map","arc","centroid","age_group","covid_case_rate","toPrecision","toLocaleString","hospitalized_case_rate"],"mappings":"4bAAA,MAAOA,CAAAA,KAAP,EAAgBC,SAAhB,CAA2BC,QAA3B,KAA2C,OAA3C,CACA,MAAOC,CAAAA,KAAP,KAAkB,OAAlB,CACA,OAASC,UAAT,KAA2B,WAA3B,CACA,OAASC,cAAT,KAA+B,cAA/B,CACA,OAASC,KAAT,KAAsB,WAAtB,CACA,OAASC,GAAT,KAAoB,WAApB,CACA,OAASC,UAAT,CAAqBC,OAArB,KAAoC,aAApC,CAEA,GAAMC,CAAAA,KAAK,CAAG,QAARA,CAAAA,KAAQ,EAAM,eACMR,QAAQ,CAAC,EAAD,CADd,wCACXS,IADW,eACLC,OADK,+BASdJ,UAAU,EATI,CAGhBK,WAHgB,aAGhBA,WAHgB,CAIhBC,WAJgB,aAIhBA,WAJgB,CAKhBC,UALgB,aAKhBA,UALgB,CAMhBC,WANgB,aAMhBA,WANgB,CAOhBC,WAPgB,aAOhBA,WAPgB,CAQhBC,WARgB,aAQhBA,WARgB,CAWlBjB,SAAS,CAAC,UAAM,CACd,wDAAC,2MACeE,CAAAA,KAAK,CAACgB,GAAN,CAAU,gFAAV,CADf,QACKC,CADL,qCAEiBA,CAAAA,CAAC,CAACT,IAFnB,QAEKU,GAFL,eAKGC,IALH,CAKU,EALV,CAMGC,KANH,CAMWF,GAAG,CAACG,KAAJ,CAAU,IAAV,CANX,CAOGC,OAPH,CAOaF,KAAK,CAAC,CAAD,CAAL,CAASC,KAAT,CAAe,GAAf,CAPb,CASUE,CATV,CASc,CATd,aASiBA,CAAC,CAAGH,KAAK,CAACI,MAT3B,2BAWKC,GAXL,CAWW,EAXX,CAYKC,IAZL,CAYYN,KAAK,CAACG,CAAD,CAAL,CAASI,OAAT,CAAiB,IAAjB,CAAuB,EAAvB,CAZZ,CAaKC,OAbL,CAaeF,IAAI,CAACL,KAAL,CAAW,GAAX,CAbf,KAeOO,OAAO,CAAC,CAAD,CAAP,CAAWC,KAAX,CAAiB,iBAAjB,CAfP,wEAiBG,IAASC,CAAT,CAAa,CAAb,CAAgBA,CAAC,CAAGR,OAAO,CAACE,MAA5B,CAAoCM,CAAC,EAArC,CAAyC,CACvCL,GAAG,CAACH,OAAO,CAACQ,CAAD,CAAP,CAAWC,WAAX,EAAD,CAAH,CAAgCH,OAAO,CAACE,CAAD,CAAP,CAAWH,OAAX,CAAmB,cAAnB,CAAmC,EAAnC,CAAhC,CACD,CAEDR,IAAI,CAACa,IAAL,CAAUP,GAAV,EArBH,QASmCF,CAAC,EATpC,+BAwBCd,OAAO,CAACU,IAAD,CAAP,CAxBD,uDAAD,KA0BD,CA3BQ,CA2BN,EA3BM,CAAT,CA6BA,GACEc,CAAAA,KAAK,CAAG,GADV,CAEEC,MAAM,CAAG,GAFX,CAGEC,MAAM,CAAGC,IAAI,CAACC,GAAL,CAASJ,KAAT,CAAgBC,MAAhB,EAA0B,GAHrC,CAKA,GAAMI,CAAAA,KAAK,CAAG,QAARA,CAAAA,KAAQ,OAAwB,IAArBC,CAAAA,CAAqB,OAArBA,CAAqB,CAAlBC,CAAkB,OAAlBA,CAAkB,CAAfC,QAAe,OAAfA,QAAe,CACpC,GAAIA,QAAQ,GAAK,IAAjB,CAAuB,CAAEA,QAAQ,CAAG,KAAX,CAAkB,CAE3C,mBACE,4BACE,UAAU,CAAE,QADd,CAEE,IAAI,CAAC,OAFP,CAGE,UAAU,CAAC,QAHb,CAIE,CAAC,CAAEF,CAAC,CAAG,IAJT,CAKE,CAAC,CAAEC,CAAC,CAAG,IALT,CAME,EAAE,CAAC,QANL,CAOE,QAAQ,CAAE,EAPZ,EASGJ,IAAI,CAACM,GAAL,CAASH,CAAT,EAAc,EAAd,CAAmB,IAAnB,CAA0BE,QAT7B,CADF,CAaD,CAhBD,CAkBA,mBACE,qDACE,2BAAK,SAAS,CAAC,YAAf,eACE,2BAAK,KAAK,CAAER,KAAZ,CAAmB,MAAM,CAAEC,MAA3B,eACE,oBAAC,cAAD,EACE,IAAI,CAAC,SADP,CAEE,EAAE,CAAC,SAFL,CAGE,EAAE,CAAC,UAHL,EADF,cAKE,oBAAC,cAAD,EACE,IAAI,CAAC,SADP,CAEE,EAAE,CAAC,SAFL,CAGE,EAAE,CAAC,YAHL,EALF,cASE,4BAAM,KAAK,CAAED,KAAb,CAAoB,MAAM,CAAEC,MAA5B,CAAoC,IAAI,CAAC,kBAAzC,CAA4D,EAAE,CAAE,EAAhE,EATF,cAUE,oBAAC,KAAD,EAAO,GAAG,CAAEA,MAAM,CAAG,CAArB,CAAwB,IAAI,CAAED,KAAK,CAAG,CAAtC,eACE,oBAAC,GAAD,EACE,IAAI,CAAEzB,IADR,CAEE,WAAW,CAAE2B,MAAM,CAAG,GAFxB,CAGE,QAAQ,CAAE,kBAAAQ,CAAC,QAAIA,CAAAA,CAAC,CAACC,UAAN,EAHb,EAKG,eAAoB,IAAjBC,CAAAA,IAAiB,OAAjBA,IAAiB,CAAXC,IAAW,OAAXA,IAAW,CACnB,MAAOD,CAAAA,IAAI,CAACE,GAAL,CAAS,SAACC,GAAD,CAAMzB,CAAN,CAAY,oBACXuB,IAAI,CAACG,QAAL,CAAcD,GAAd,CADW,kDACnBT,CADmB,oBAChBC,CADgB,oBAE1B,mBACE,yBAAG,GAAG,mBAAajB,CAAb,CAAN,eACE,4BACE,CAAC,CAAEuB,IAAI,CAACE,GAAD,CADT,CAEE,IAAI,CAAC,oBAFP,CAGE,MAAM,CAAC,OAHT,CAIE,YAAY,CAAE,8BACZlC,CAAAA,WAAW,CAAC,CACVJ,WAAW,CAAEsC,GAAG,CAACxC,IADP,CAEVG,WAAW,CAAE4B,CAFH,CAGV3B,UAAU,CAAE4B,CAHF,CAAD,CADC,EAJhB,CAWE,YAAY,CAAEzB,WAXhB,EADF,cAcE,oBAAC,KAAD,EAAO,CAAC,CAAEwB,CAAV,CAAa,CAAC,CAAEC,CAAhB,EACGQ,GAAG,CAACxC,IAAJ,CAAS0C,SADZ,CAdF,CADF,CAoBD,CAtBM,CAAP,CAuBD,CA7BH,CADF,CAVF,CADF,CA6CGrC,WAAW,eACV,oBAAC,OAAD,EAAS,IAAI,CAAEF,WAAW,CAAG,GAAd,CAAoBsB,KAAnC,CAA0C,GAAG,CAAErB,UAAU,CAAG,IAAb,CAAoBsB,MAAnE,eACE,+BAAS,SAAS,CAAC,SAAnB,eACE,8CADF,KAC8BxB,WAAW,CAACwC,SAD1C,cACoD,8BADpD,cAEE,8CAFF,KAE8B,CAACxC,WAAW,CAACyC,eAAZ,CAA8B,IAA/B,EAAqCC,WAArC,CAAiD,CAAjD,EAAoDC,cAApD,EAF9B,kBAEoG,8BAFpG,cAGE,yDAHF,KAGyC,CAAC3C,WAAW,CAAC4C,sBAAZ,CAAqC,IAAtC,EAA4CF,WAA5C,CAAwD,CAAxD,EAA2DC,cAA3D,EAHzC,kBAGsH,8BAHtH,cAIE,+CAJF,KAI+B,CAAC3C,WAAW,CAACkC,UAAZ,CAAyB,IAA1B,EAAgCQ,WAAhC,CAA4C,CAA5C,EAA+CC,cAA/C,EAJ/B,kBAIgG,8BAJhG,CADF,CA9CJ,CADF,cAyDE,2BAAK,SAAS,CAAC,SAAf,eACE,2BAAK,SAAS,CAAC,YAAf,eACE,4BAAM,SAAS,CAAC,mBAAhB,eADF,CADF,cAIE,2BAAK,SAAS,CAAC,UAAf,eACE,4BAAM,SAAS,CAAC,aAAhB,uFADF,CAJF,CAzDF,CADF,CAsED,CArID,CAuIA,cAAe9C,CAAAA,KAAf","sourcesContent":["import React, { useEffect, useState } from 'react'\nimport axios from 'axios'\nimport { localPoint } from '@vx/event'\nimport { LinearGradient } from '@vx/gradient'\nimport { Group } from '@vx/group'\nimport { Pie } from '@vx/shape'\nimport { useTooltip, Tooltip } from '@vx/tooltip'\n\nconst Compc = () => {\n  const [data, setData] = useState([])\n  const {\n    tooltipData,\n    tooltipLeft,\n    tooltipTop,\n    tooltipOpen,\n    showTooltip,\n    hideTooltip\n  } = useTooltip()\n\n  useEffect(() => {\n    (async() => {\n      let a = await axios.get('https://raw.githubusercontent.com/nychealth/coronavirus-data/master/by-age.csv')\n      let res = await a.data\n\n      let \n        dump = [],\n        lines = res.split('\\r'),\n        headers = lines[0].split(',')\n    \n      for (let i = 1; i < lines.length; i++) {\n        let \n          obj = {},\n          line = lines[i].replace('\\n', ''),\n          curLine = line.split(',')\n\n        if (curLine[0].match(/Citywide\\s\\S+/gi)) continue\n    \n        for (var j = 0; j < headers.length; j++) {\n          obj[headers[j].toLowerCase()] = curLine[j].replace(/[\\sA-Za-z]/gi, '')\n        }\n    \n        dump.push(obj)\n      }\n\n      setData(dump)\n    })()\n  }, [])\n\n  const \n    width = 650,\n    height = 400,\n    radius = Math.min(width, height) - 100\n\n  const Label = ({ x, y, children }) => {\n    if (children === \"75\") { children = \"75+\" }\n    \n    return (\n      <text\n        fontFamily={\"Snoopy\"}\n        fill=\"white\"\n        textAnchor=\"middle\"\n        x={x * 1.25}\n        y={y * 1.25}\n        dy=\"-.25em\"\n        fontSize={16}\n      >\n        {Math.abs(x) < 10 ? null : children}\n      </text>\n    )\n  }\n\n  return (\n    <>\n      <div className=\"svgWrapper\">\n        <svg width={width} height={height}>\n          <LinearGradient \n            from=\"#fbc2eb\" \n            to=\"#ede1ed\" \n            id=\"gradient\"/>\n          <LinearGradient \n            from=\"#736ca3\" \n            to=\"#b8c1e3\" \n            id=\"gradient-2\"/>\n          <rect width={width} height={height} fill=\"url('#gradient')\" rx={14} />\n          <Group top={height / 2} left={width / 2}>\n            <Pie\n              data={data}\n              outerRadius={radius - 115}\n              pieValue={d => d.death_rate}\n            >\n              {({ arcs, path }) => {\n                return arcs.map((arc, i) => {\n                  const [x, y] = path.centroid(arc);\n                  return (\n                    <g key={`pie-arc-${i}`}>\n                      <path\n                        d={path(arc)}\n                        fill=\"url('#gradient-2')\"\n                        stroke=\"white\"\n                        onMouseEnter={() =>\n                          showTooltip({\n                            tooltipData: arc.data,\n                            tooltipLeft: x,\n                            tooltipTop: y\n                          })\n                        }\n                        onMouseLeave={hideTooltip}\n                      />\n                      <Label x={x} y={y}>\n                        {arc.data.age_group}\n                      </Label>\n                    </g>\n                  )\n                })\n              }}\n            </Pie>\n          </Group>\n        </svg>\n        {tooltipOpen && (\n          <Tooltip left={tooltipLeft * .75 + width} top={tooltipTop * 1.25 + height}>\n            <section className=\"ttStyle\">\n              <strong>Age Group</strong> {tooltipData.age_group}<br />\n              <strong>Case Rate</strong> {(tooltipData.covid_case_rate / 1000).toPrecision(3).toLocaleString()}%<br />\n              <strong>Hospitalization Rate</strong> {(tooltipData.hospitalized_case_rate / 1000).toPrecision(3).toLocaleString()}%<br />\n              <strong>Death Rate</strong> {(tooltipData.death_rate / 1000).toPrecision(3).toLocaleString()}%<br />\n            </section>\n          </Tooltip>\n        )}\n      </div>\n      <div className=\"descDiv\">\n        <div className=\"headerWrap\">\n          <span className=\"descriptionHeader\">Age Groups</span>\n        </div>\n        <div className=\"descWrap\">\n          <span className=\"description\">\n            This contains age-specific rates of confirmed cases, hospitalizations, and deaths.\n          </span>\n        </div>\n      </div>\n    </>\n  )\n}\n\nexport default Compc\n"]},"metadata":{},"sourceType":"module"}