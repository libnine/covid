{"ast":null,"code":"var _jsxFileName = \"/Users/qorka/Projects/covid/ui/src/components/compc.js\";\nimport React, { useEffect, useState } from 'react';\nimport axios from 'axios';\nimport { localPoint } from '@vx/event';\nimport { LinearGradient } from '@vx/gradient';\nimport { Group } from '@vx/group';\nimport { Pie } from '@vx/shape';\nimport { useTooltip, Tooltip } from '@vx/tooltip';\n\nconst Compc = () => {\n  const [data, setData] = useState([]);\n  const {\n    tooltipData,\n    tooltipLeft,\n    tooltipTop,\n    tooltipOpen,\n    showTooltip,\n    hideTooltip\n  } = useTooltip();\n  useEffect(() => {\n    (async () => {\n      let a = await axios.get('https://raw.githubusercontent.com/nychealth/coronavirus-data/master/by-age.csv');\n      let res = await a.data;\n      let dump = [],\n          lines = res.split('\\r'),\n          headers = lines[0].split(',');\n\n      for (let i = 1; i < lines.length; i++) {\n        let obj = {},\n            line = lines[i].replace('\\n', ''),\n            curLine = line.split(',');\n        if (curLine[0].match(/Citywide\\s\\S+/gi)) continue;\n\n        for (var j = 0; j < headers.length; j++) {\n          obj[headers[j].toLowerCase()] = curLine[j].replace(/[\\sA-Za-z]/gi, '');\n        }\n\n        dump.push(obj);\n      }\n\n      setData(dump);\n    })();\n  }, []);\n  const width = 650,\n        height = 400,\n        radius = Math.min(width, height) - 100;\n  let tooltipTimeout;\n\n  const Label = ({\n    x,\n    y,\n    children\n  }) => {\n    if (children === \"75\") {\n      children = \"75+\";\n    }\n\n    return /*#__PURE__*/React.createElement(\"text\", {\n      fontFamily: \"Snoopy\",\n      fill: \"white\",\n      textAnchor: \"middle\",\n      x: x * 1.25,\n      y: y * 1.25,\n      dy: \"-.25em\",\n      fontSize: 16,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 60,\n        columnNumber: 7\n      }\n    }, Math.abs(x) < 10 ? null : children);\n  };\n\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"svgWrapper\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"svg\", {\n    width: width,\n    height: height,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(LinearGradient, {\n    from: \"#b39cea\",\n    to: \"#e99cea\",\n    id: \"gradient\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 78,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(\"rect\", {\n    width: width,\n    height: height,\n    fill: \"#fbc2eb\",\n    rx: 14,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(Group, {\n    top: height / 2,\n    left: width / 2,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(Pie, {\n    data: data,\n    outerRadius: radius - 115,\n    pieValue: d => d.death_rate,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 13\n    }\n  }, ({\n    arcs,\n    path\n  }) => {\n    return arcs.map((arc, i) => {\n      const [x, y] = path.centroid(arc);\n      return /*#__PURE__*/React.createElement(\"g\", {\n        key: `pie-arc-${i}`,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 93,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(\"path\", {\n        d: path(arc),\n        fill: \"url(#gradient)\",\n        stroke: \"white\",\n        onMouseEnter: () => showTooltip({\n          tooltipData: arc.data,\n          tooltipLeft: x,\n          tooltipTop: y\n        }),\n        onMouseLeave: hideTooltip,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 94,\n          columnNumber: 23\n        }\n      }), /*#__PURE__*/React.createElement(Label, {\n        x: x,\n        y: y,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 107,\n          columnNumber: 23\n        }\n      }, arc.data.age_group));\n    });\n  })))), tooltipOpen && /*#__PURE__*/React.createElement(Tooltip, {\n    left: tooltipLeft * .75 + width,\n    top: tooltipTop + height,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 119,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"ttStyle\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 120,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"strong\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 15\n    }\n  }, \"Zip\"), \" \", tooltipData.death_rate, /*#__PURE__*/React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 60\n    }\n  }))) //   <div\n  //     className=\"tooltip\"\n  //     style={{\n  //       position: \"absolute\",\n  //       top: tooltipTop + height,\n  //       left: tooltipLeft + width,\n  //       pointerEvents: \"none\",\n  //       background: \"rgba(0,0,0,0.3)\"\n  //     }}\n  //   >\n  //   {JSON.stringify(tooltipData, undefined, \"\\n\")}\n  // </div>\n  , /*#__PURE__*/React.createElement(\"div\", {\n    className: \"descDiv\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 139,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"headerWrap\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 140,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    className: \"descriptionHeader\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 141,\n      columnNumber: 11\n    }\n  }, \"Age Groups\")), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"descWrap\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 143,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    className: \"description\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 144,\n      columnNumber: 11\n    }\n  }, \"This contains age-specific rates of confirmed cases, hospitalizations, and deaths.\"))));\n};\n\nexport default Compc;","map":{"version":3,"sources":["/Users/qorka/Projects/covid/ui/src/components/compc.js"],"names":["React","useEffect","useState","axios","localPoint","LinearGradient","Group","Pie","useTooltip","Tooltip","Compc","data","setData","tooltipData","tooltipLeft","tooltipTop","tooltipOpen","showTooltip","hideTooltip","a","get","res","dump","lines","split","headers","i","length","obj","line","replace","curLine","match","j","toLowerCase","push","width","height","radius","Math","min","tooltipTimeout","Label","x","y","children","abs","d","death_rate","arcs","path","map","arc","centroid","age_group"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react'\nimport axios from 'axios'\nimport { localPoint } from '@vx/event'\nimport { LinearGradient } from '@vx/gradient'\nimport { Group } from '@vx/group'\nimport { Pie } from '@vx/shape'\nimport { useTooltip, Tooltip } from '@vx/tooltip'\n\nconst Compc = () => {\n  const [data, setData] = useState([])\n  const {\n    tooltipData,\n    tooltipLeft,\n    tooltipTop,\n    tooltipOpen,\n    showTooltip,\n    hideTooltip\n  } = useTooltip()\n\n  useEffect(() => {\n    (async() => {\n      let a = await axios.get('https://raw.githubusercontent.com/nychealth/coronavirus-data/master/by-age.csv')\n      let res = await a.data\n\n      let \n        dump = [],\n        lines = res.split('\\r'),\n        headers = lines[0].split(',')\n    \n      for (let i = 1; i < lines.length; i++) {\n        let \n          obj = {},\n          line = lines[i].replace('\\n', ''),\n          curLine = line.split(',')\n\n        if (curLine[0].match(/Citywide\\s\\S+/gi)) continue\n    \n        for (var j = 0; j < headers.length; j++) {\n          obj[headers[j].toLowerCase()] = curLine[j].replace(/[\\sA-Za-z]/gi, '')\n        }\n    \n        dump.push(obj)\n      }\n\n      setData(dump)\n    })()\n  }, [])\n\n  const \n    width = 650,\n    height = 400,\n    radius = Math.min(width, height) - 100\n  \n  let tooltipTimeout\n\n  const Label = ({ x, y, children }) => {\n    if (children === \"75\") { children = \"75+\" }\n    \n    return (\n      <text\n        fontFamily={\"Snoopy\"}\n        fill=\"white\"\n        textAnchor=\"middle\"\n        x={x * 1.25}\n        y={y * 1.25}\n        dy=\"-.25em\"\n        fontSize={16}\n      >\n        {Math.abs(x) < 10 ? null : children}\n      </text>\n    )\n  }\n\n  return (\n    <>\n      <div className=\"svgWrapper\">\n        <svg width={width} height={height}>\n          <LinearGradient \n            from=\"#b39cea\" \n            to=\"#e99cea\" \n            id=\"gradient\"/>\n          <rect width={width} height={height} fill=\"#fbc2eb\" rx={14} />\n          <Group top={height / 2} left={width / 2}>\n            <Pie\n              data={data}\n              outerRadius={radius - 115}\n              pieValue={d => d.death_rate}\n            >\n              {({ arcs, path }) => {\n                return arcs.map((arc, i) => {\n                  const [x, y] = path.centroid(arc);\n                  return (\n                    <g key={`pie-arc-${i}`}>\n                      <path\n                        d={path(arc)}\n                        fill=\"url(#gradient)\"\n                        stroke=\"white\"\n                        onMouseEnter={() =>\n                          showTooltip({\n                            tooltipData: arc.data,\n                            tooltipLeft: x,\n                            tooltipTop: y\n                          })\n                        }\n                        onMouseLeave={hideTooltip}\n                      />\n                      <Label x={x} y={y}>\n                        {arc.data.age_group}\n                      </Label>\n                    </g>\n                  )\n                })\n              }}\n            </Pie>\n          </Group>\n        </svg>\n      </div>\n        {tooltipOpen && (\n          <Tooltip left={tooltipLeft * .75 + width} top={tooltipTop + height}>\n            <div className=\"ttStyle\">\n              <strong>Zip</strong> {tooltipData.death_rate}<br />\n              {/* <strong>Total</strong> {Number(total(tooltipData)).toLocaleString()}<br /> */}\n              {/* <strong>Positive</strong> {Number(y(tooltipData)).toLocaleString()} */}\n            </div>\n          </Tooltip>\n          //   <div\n          //     className=\"tooltip\"\n          //     style={{\n          //       position: \"absolute\",\n          //       top: tooltipTop + height,\n          //       left: tooltipLeft + width,\n          //       pointerEvents: \"none\",\n          //       background: \"rgba(0,0,0,0.3)\"\n          //     }}\n          //   >\n          //   {JSON.stringify(tooltipData, undefined, \"\\n\")}\n          // </div>\n        )}\n      <div className=\"descDiv\">\n        <div className=\"headerWrap\">\n          <span className=\"descriptionHeader\">Age Groups</span>\n        </div>\n        <div className=\"descWrap\">\n          <span className=\"description\">\n            This contains age-specific rates of confirmed cases, hospitalizations, and deaths.\n          </span>\n        </div>\n      </div>\n    </>\n  )\n}\n\nexport default Compc\n"]},"metadata":{},"sourceType":"module"}